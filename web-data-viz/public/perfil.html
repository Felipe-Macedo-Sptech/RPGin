<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link
            href="https://fonts.googleapis.com/css2?family=Cascadia+Code:ital,wght@0,200..700;1,200..700&family=Comic+Relief:wght@400;700&display=swap"
            rel="stylesheet">
        <title>Área do Usuário</title>
        <script src="./js/sessao.js"></script>
        <link rel="stylesheet" href="./CSS/perfil.css">
    </head>
<body onload="validarSessao()">

    <div class="header">
        <div class="container">
            <a href="areaUser.html">
            <div class="logo">
               <img src="./img/RPGin (1).png">
            </div>
        </a>
            <div class="pesquisa">
                <input class="pesquisaAreaUser" type="text" placeholder="pesquisar no RPGin....">
            </div>
        </div>
    </div>


    <div id="n_user"></div>

    <button onclick="postarModal()">
        POSTAR
    </button>

    <dialog>
        <form id="formPostagem" onsubmit="event.preventDefault(); postar();">
            <div id="campoTitulo">
            Título da postagem: <br>
            <input type="text" id="inp_titulo"><br><br>
            </div>
            <div id="campoConteudo">
                Conteúdo do post:<br>
                <textarea id="inp_postagem" rows="4" cols="50"></textarea>
            </div>
        </form>
        <button onclick="postar()">VAMOO</button>
        <button onclick="fecharModal()">Fechar</button>
        
    </dialog>
    
</body>
</html>

<script>
    
    const modal = document.querySelector("dialog");
    idSessao = sessionStorage.ID_USUARIO

function postar(){
    var titulo = inp_titulo.value;
    var post = inp_postagem.value;
    var id = Number(idSessao)

    console.log(id)

    fetch('/postagem/postar',{
        method: 'POST',
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            tituloServer: titulo,
            postServer: post,
            id_userServer: id

        })
    }).then(function (resposta){
        if(resposta.ok){
            console.log("marcgha papai");
            modal.close()
        }  
    })
}


    function postarModal(){
        modal.showModal();
    };
    function fecharModal(){
        modal.close();
    };

</script>