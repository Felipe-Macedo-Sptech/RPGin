<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/dashboardCerta.css">
</head>
<body onload="inicarDashboard()">
<div class="main">
    <div class="areaDashboard">
    <div class="indicadores">
        <div class="cadastrados">
            <span>Total de cadastros</span>
            <div id="cadastrados"></div>
        </div>


        <div class="postagemCriadas">
            <span>Postagem mais curtida</span>
            <div id="postagemCriadas"></div>
        </div>


        <div class="curtidaPostagem">
            <span>Media de curtida por postagem</span>
            <div id="curtidaPostagem"></div>
        </div>

          <div class="comenPorPostagem">
            <span>Media de comentario por postagem</span>
            <div id="comenPorPostagem"></div>
        </div>
    </div>

    <div class="graficos">
        
        <div class="linha">
            <canvas id="linha"></canvas>
        </div>
        <div class="pizza">
            <canvas id="pizza"></canvas>
        </div>
    </div>
    </div>
</div>
</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>

  function inicarDashboard(){
    exibirUsuariosCadastrados();
    postagensCriadas();
    curtidaPostagem();
    usuarioPostagem()
  }
  const ctx = document.getElementById('linha');
  new Chart(ctx, {
    type: 'line',
    data: {
      labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
      datasets: [{
        label: '# of Votes',
        data: [12, 19, 3, 5, 2, 23],
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      }
    }
  });
function usuarioPostagem(){
     fetch('/dashboard/usuarioPostagem',{
        method: 'GET',
         headers: {
        "Content-Type": "application/json"
      }
    }).then(res => res.json())
    .then(function (resultado) {
        var primeiro = Number(resultado[0].postagens)
        var segundo = Number(resultado[1].postagens)
        var terceiro = Number(resultado[2].postagens)
        var quarto = Number(resultado[3].postagens)
        var quinto = Number(resultado[4].postagens)

         const ctx2 = document.getElementById('pizza');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                labels: [`${resultado[0].nome}`, `${resultado[1].nome}`, `${resultado[2].nome}`, `${resultado[3].nome}`, `${resultado[4].nome}`],
                datasets: [
                    {
                        label: 'Postagens',
                        data: [primeiro, segundo, terceiro, quarto, quinto],
                        borderColor: '#fff',
                        backgroundColor: ['#fca311', '#fff']
                    },
            
                 ]
                },
                options: {
                scales: {
                    y: {
                    beginAtZero: true
                    }
                }
                }
            });
    });
  }
  function exibirUsuariosCadastrados(){
    fetch('/dashboard/usuariosCadastrados',{
        method: 'GET',
         headers: {
        "Content-Type": "application/json"
      }
    }).then(res => res.json())
    .then(function (resultado) {
    var cadastros = document.getElementById('cadastrados')
        cadastros.innerHTML = `${resultado[0].cadastrados}`
    });
  }

  function postagensCriadas(){
     fetch('/dashboard/postagensCriadas',{
        method: 'GET',
         headers: {
        "Content-Type": "application/json"
      }
    }).then(res => res.json())
    .then(function (resultado) {
    var postagem = document.getElementById('postagemCriadas')
        postagem.innerHTML = `${resultado[0].postagem}`
    });
  }

    function curtidaPostagem(){
     fetch('/dashboard/curtidaPostagem',{
        method: 'GET',
         headers: {
        "Content-Type": "application/json"
      }
    }).then(res => res.json())
    .then(function (resultado) {
    var curtida = document.getElementById('curtidaPostagem')
        curtida.innerHTML = `${resultado[0].Media}`
    });
  }

  

  



</script>